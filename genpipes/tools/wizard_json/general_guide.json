{
    "_meta": {
        "entry_point": "start_general_guide",
        "version": 1.0,
        "description": "General guide to determine if user needs help selecting the appropriate deployment method, pipeline, protocol, and/or constructing the command to run GenPipes"
    },
    "nodes": [
        {
            "id": "start_general_guide",
            "type": "confirm", 
            "question": "Do you need help deploying GenPipes?",
            "options": [
                {
                    "label": "Yes",
                    "next": {
                        "external": "deployment_guide.json",
                        "entryPoint": "start_deployment_guide"
                    }
                },
                {
                    "label": "No",
                    "next": {
                        "node": "pipeline_help"
                    }
                }
            ]
        },



        {
            "id": "pipeline_help",
            "type": "confirm", 
            "question": "Do you need help finding the pipeline that fits your dataset and your analysis goals?",
            "options": [
                {
                    "label": "Yes",
                    "next": {
                        "external": "pipeline_guide.json",
                        "entryPoint": "start_pipeline_guide"
                    }
                },
                {
                    "label": "No",
                    "next": {
                        "node": "pipeline_selection"
                    }
                }
            ] 
        },
        {
            "id": "pipeline_selection",
            "type": "selection",
            "question": "Select the pipeline you are using:",
            "choices": [
              { "label": "ampliconseq", "node": "ampliconseq_pipeline_selected" },
              { "label": "chipseq", "node": "chipseq_pipeline_selected" },
              { "label": "covseq", "node": "covseq_pipeline_selected" },
              { "label": "dnaseq", "node": "dnaseq_pipeline_selected" },
              { "label": "longread_dnaseq", "node": "longread_dnaseq_pipeline_selected" },
              { "label": "methylseq", "node": "methylseq_pipeline_selected" },
              { "label": "nanopore_covseq", "node": "nanopore_covseq_pipeline_selected" },
              { "label": "rnaseq", "node": "rnaseq_pipeline_selected" },
              { "label": "rnaseq_denovo_assembly", "node": "rnaseq_denovo_assembly_pipeline_selected" },
              { "label": "rnaseq_light", "node": "rnaseq_light_pipeline_selected" }
            ]
        },
        {
            "id": "ampliconseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "ampliconseq",
            "next": {
              "node": "pipeline_choice_message_next_command"
            }
        },
        {
            "id": "chipseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "chipseq",
            "next": {
              "node": "pipeline_choice_message_next_protocol"
            }
        },
        {
            "id": "covseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "covseq",
            "next": {
              "node": "pipeline_choice_message_next_command"
            }
        },
        {
            "id": "dnaseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "dnaseq",
            "next": {
              "node": "pipeline_choice_message_next_protocol"
            }
        },
        {
            "id": "longread_dnaseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "longread_dnaseq",
            "next": {
              "node": "pipeline_choice_message_next_protocol" 
            }
        },
        {
            "id": "methylseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "methylseq",
            "next": {
              "node": "pipeline_choice_message_next_protocol"
            }
        },
        {
            "id": "nanopore_covseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "nanopore_covseq",
            "next": {
              "node": "pipeline_choice_message_next_command"
            }
        },
        {
            "id": "rnaseq_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "rnaseq",
            "next": {
              "node": "pipeline_choice_message_next_protocol"
            }
        },
        {
            "id": "rnaseq_denovo_assembly_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "rnaseq_denovo_assembly",
            "next": {
              "node": "pipeline_choice_message_next_protocol"
            }
        },
        {
            "id": "rnaseq_light_pipeline_selected",
            "type": "set_variable",
            "variable": "pipeline_name",
            "value": "rnaseq_light",
            "next": {
              "node": "pipeline_choice_message_next_command"
            }
        },
        {
            "id": "pipeline_choice_message_next_protocol",
            "type": "message",
            "message": "Your choice of pipeline to run GenPipes is: {pipeline_name}",
            "next": "protocol_help"
        },
        {
            "id": "pipeline_choice_message_next_command",
            "type": "message",
            "message": "Your choice of pipeline to run GenPipes is: {pipeline_name}",
            "next": "command_help"
        },



        {
            "id": "protocol_help",
            "type": "confirm",
            "question": "Do you need help choosing the protocol for your pipeline?",
            "options": [
                {
                    "label": "Yes",
                    "next": {
                        "external": "protocol_guide.json",
                        "entryPoint": "start_protocol_guide"
                    }
                },
                {
                    "label": "No",
                    "next": {
                        "node": "protocol_selection"
                    }
                }
            ]
        },
        {
            "id": "protocol_selection",
            "type": "selection",
            "question": "Select the protocol you are using:",
            "choices_cases": [
              {
                "when": { "equals": { "pipeline_name": "chipseq" } },
                "choices": [
                  { "label": "chipseq", "node": "chipseq_protocol_selected" },
                  { "label": "atacseq", "node": "atacseq_protocol_selected" }
                ]
              },
              {
                "when": { "equals": { "pipeline_name": "dnaseq" } },
                "choices": [
                  { "label": "germline_snv", "node": "germline_snv_protocol_selected" },
                  { "label": "germline_sv", "node": "germline_sv_protocol_selected" },
                  { "label": "germline_high_cov", "node": "germline_high_cov_protocol_selected" },
                  { "label": "somatic_tumor_only", "node": "somatic_tumor_only_protocol_selected" },
                  { "label": "somatic_fastpass", "node": "somatic_fastpass_protocol_selected" },
                  { "label": "somatic_ensemble", "node": "somatic_ensemble_protocol_selected" },
                  { "label": "somatic_sv", "node": "somatic_sv_protocol_selected" }
                ]
              },
              {
                "when": { "equals": { "pipeline_name": "longread_dnaseq" } },
                "choices": [
                  { "label": "nanopore", "node": "nanopore_protocol_selected" },
                  { "label": "revio", "node": "revio_protocol_selected" }
                ]
              },
              {
                "when": { "equals": { "pipeline_name": "methylseq" } },
                "choices": [
                  { "label": "bismark", "node": "bismark_protocol_selected" },
                  { "label": "gembs", "node": "gembs_protocol_selected" },
                  { "label": "dragen", "node": "dragen_protocol_selected" },
                  { "label": "hybrid", "node": "hybrid_protocol_selected" }
                ]
              },
              {
                "when": { "equals": { "pipeline_name": "rnaseq" } },
                "choices": [
                  { "label": "stringtie", "node": "stringtie_protocol_selected" },
                  { "label": "variants", "node": "variants_protocol_selected" },
                  { "label": "cancer", "node": "cancer_protocol_selected" }
                ]
              },
              {
                "when": { "equals": { "pipeline_name": "rnaseq_denovo_assembly" } },
                "choices": [
                  { "label": "trinity", "node": "trinity_protocol_selected" },
                  { "label": "seq2fun", "node": "seq2fun_protocol_selected" }
                ]
              }
            ]
        },          
        {
            "id": "chipseq_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "chipseq",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "atacseq_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "atacseq",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "germline_sv_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "germline_sv",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "germline_snv_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "germline_snv",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "germline_high_cov_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "germline_high_cov",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "somatic_ensemble_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "somatic_ensemble",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "somatic_tumor_only_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "somatic_tumor_only",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "somatic_sv_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "somatic_sv",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "somatic_fastpass_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "somatic_fastpass",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "nanopore_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "nanopore",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "revio_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "revio",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "bismark_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "bismark",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "gembs_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "gembs",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "dragen_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "dragen",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "hybrid_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "hybrid",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "cancer_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "cancer",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "variants_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "variants",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "stringtie_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "stringtie",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "seq2fun_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "seq2fun",
            "next": {
              "node": "command_help"
            }
        },
        {
            "id": "trinity_protocol_selected",
            "type": "set_variable",
            "variable": "protocol_name",
            "value": "trinity",
            "next": {
              "node": "command_help"
            }
        },



        {
            "id": "command_help",
            "type": "confirm", 
            "question": "Do you need help writing the command to run your pipeline?",
            "options": [
                {
                    "label": "Yes",
                    "next": {
                        "external": "command_guide.json",
                        "entryPoint": "start_command_guide"
                    }
                },
                {
                    "label": "No",
                    "next": {
                        "node": "end"
                    }
                }
            ] 
        },
        {
            "id": "end",
            "type": "message",
            "message": "Thank you for using the GenPipes Wizard. Best of luck with your analysis! For additional support, run genpipes -h or consult the readthedocs."
          }
          
    ]
}